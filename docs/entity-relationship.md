# TaskyNote - Entity Relationship Definitions

**Version:** 1.0  
**Last Updated:** 27.04.2025

---

## 1. Overview

This document defines the main entities and relationships between them for the TaskyNote project. The system allows users to create notes and tasks, tag them, and manage task dependencies.

## 2. Entities and Fields

### 2.1. User

| Field | Type | Nullable | Default | Description |
| :-- | :-- | :-- | :-- | :-- |
| id | UUID (PK) | No | - | Unique identifier of the user |
| username | String | No | - | Username of the user |
| email | String | No | - | Email address of the user |
| password | String | No | - | Hashed password |
| name | String | Yes | null | First name of the user |
| surname | String | Yes | null | Last name of the user |
| created_at | Timestamp | No | now() | Creation time |
| updated_at | Timestamp | No | now() | Last update time |

### 2.2. Note

| Field | Type | Nullable | Default | Description |
| :-- | :-- | :-- | :-- | :-- |
| id | UUID (PK) | No | - | Unique identifier of the note |
| user_id | UUID (FK) | No | - | Owner user ID |
| title | String | No | - | Title of the note |
| content | Text | Yes | null | Body of the note | 
| created_at | Timestamp | No | now() | Creation time |
| updated_at | Timestamp | No | now() | Last update time |

### 2.3. Task

| Field | Type | Nullable | Default | Description |
| :-- | :-- | :-- | :-- | :-- |
| id | UUID (PK) | No | - | Unique identifier of the task | 
| user_id | UUID (FK) | No | - | Owner user ID |
| title | String | No | - | Title of the task |
| description | Text | Yes | null | Details of the task | 
| due_date | Date | Yes | null | Due date of the task |
| completed | Boolean | No | false | Task completion status |
| prerequisite_task_id | UUID (FK) | Yes | null | Dependent prerequisite task ID |
| created_at | Timestamp | No | now() | Creation time |
| updated_at | Timestamp | No | now() | Last update time |

### 2.4. Tag

| Field | Type | Nullable | Default | Description |
| :-- | :-- | :-- | :-- | :-- |
| id | UUID (PK) | No | - |Unique identifier of the tag |
| user_id | UUID (FK) | No | - | Owner user ID |
| name | String | No | - | Name of the tag |
| created_at | Timestamp | No | now() | Creation time |
| updated_at | Timestamp | No | now() | Last update time |

## 3. Relationships

| From | To | Type | Cascade Action | Description |
| :-- | :-- | :-- | :-- | :-- |
| User | Note | One-to-Many | On Delete Cascade | A user can have multiple notes |
| User | Task | One-to-Many | On Delete Cascade | A user can have multiple tasks |
| User | Tag | One-to-Many | On Delete Cascade | A user can have multiple tags |
| Note | Tag | Many-to-Many | None | A note can have multiple tags and a tag can be associated with multiple notes |
| Task | Tag | Many-to-Many | None | A task can have multiple tags and a tag can be associated with multiple tasks |
| Task | Note | Many-to-Many | None | A task can be linked to multiple notes as supportive materials |
| Task | Task (self-relation) | One-to-One (optional) | None | A task may depend on the completion of another task |

## 4. Join Tables

There are three join tables:

    1. note_tag
    2. task_tag
    3. task_note

| Join Table | Columns| Description |
| :-- | :-- | :-- |
| note_tag | note_id (FK), tag_id (FK) | Links notes and tags |
| task_tag | task_id (FK), tag_id (FK) | Links tasks and tags | 
| task_note | task_id (FK), note_id (FK) | Links tasks and notes |

## 5. Notes

- All timestamps (`created_at` and `updated_at`) are automatically generated by the system.
- All UUIDs are system-generated unique IDs.
- Deleting a `User` should cascade delete `Notes`, `Tasks`, `Tags` and their associations.
- Deleting a `Tag` should remove links to associated `Notes` and `Tasks`.
- Deleting a `Note` or `Task` should clean up any relationships automatically.